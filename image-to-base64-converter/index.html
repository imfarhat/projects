<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" href="https://raw.githubusercontent.com/farhateservices/fesa/main/logo-head-white.png" type="image/x-icon">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="icon" type="image/png" href="images/tab-top.PNG">
  <title>File Reader by I Farhat</title>
</head>
<body class="bg-blue-100 p-4 flex flex-col items-center justify-center">
  <h1 class="p-4 font-semibold text-center text-sm md:text-base flex flex-wrap items-center justify-center">Image file <span class="hidden md:flex">(jpg, jpeg, png, gif)</span> Reader and Base64 Code Generator</h1>
  <form action="#" name="form" id="form" class="p-6 w-full grid grid-cols-1 max-w-4xl items-center justify-center gap-4">
    <div class="w-full flex flex-wrap items-center justify-center bg-white rounded-md py-6 gap-x-2 md:gap-x-6 lg:gap-x-8 xl:gap-x-12 gap-y-2 p-2">
      <label for="input-file" class="font-semibold p-2 text-sm md:text-base">Drag & Drop an Image File</label>
      <input id="input-file" accept="image/png, image/gif, image/jpeg" class="p-2 text-sm md:text-base" type="file"></input>
    </div>
    <div id="img-preview-div" class="p-4 rounded-md hidden bg-white grid grid-cols-1 items-center justify-center">
      <h1 id="selected-file-name" lass="p-4 text-center w-full"></h1>
      <img id="img-preview" src="" alt="Previewing selected file" class="bg-white rounded max-w-52">
    </div>

    <div id="message" class="p-4 bg-white rounded-md w-full flex-col items-center justify-center bg-white rounded-md gap-6">
      <span id="message-title" class="font-semibold w-full text-sm md:text-base">Progress will be logged here...</span>
      <li id="log-0" class="list-disc text-green-600 text-sm md:text-base hidden">Loading logs... </li>
    </div>

    <details id="log-history" class="hidden rounded-md bg-white p-4">
      <summary class="font-semibold transition rounded-md pb-2 text-sm md:text-base cursor-pointer">Detailed Log History</summary>
    </details>

    <div id="output-b64-div" class="p-4 bg-white rounded-t-md flex items-center justify-between hidden cursor-pointer hover:bg-blue-200 select-none">
      <h1 id="copy-b64-message" class="font-semibold">Copy generated Base64 Code <i class="fa-solid fa-clipboard text-xl pl-2"></i></h1>
      <img id="output-b64-tick-img" src="https://storage.needpix.com/rsynced_images/check-mark-2180770_1280.png" alt="Base64 Code Copied" class="h-6 hidden animate-pulse">
    </div>

    <div>
      <textarea name="base64" id="base64-snippet" rows="8" class="w-full rounded-b-md bg-blue-50 -mt-4 p-4 focus:outline-none hidden">Loading base64 code...</textarea>
    </div>

    <a id="output-d-file" href="" download class="grid grid-cols-1 items-center justify-center gap-2 font-semibold bg-white rounded-md p-6 hidden w-full group">
      <img id="output-f-src" src="" alt="Regenerated Image from Base64" class="max-w-96 pb-2">
      <div class="flex flex-wrap items-center justify-center p-2 rounded-md group-hover:bg-blue-200 group-active:scale-90 transition select-none">
        <img src="https://cdn-icons-png.flaticon.com/128/7268/7268609.png" alt="Download" class="h-8 md:h-10 p-2">
        <h1 class="p-2 text-sm md:text-base">Regenerated File</h1>
      </div>
    </a> 

  </form>

  <footer class="flex items-center flex-col justify-center">
    <div id="copyright" class="max-w-2xl flex items-center flex-col justify-center md:flex-row md:justify-between p-2 px-6 gap-x-4 bg-blue-100 text-sm"><span class="hidden md:flex">&copy; 2024 File Reader by I. Farhat. All rights reserved. </span><a href="https://farhateservices.github.io/fesa/" target="_blank"><span class="flex flex-row gap-1 items-center justify-center"><span class="hidden md:flex">Powered by</span> <img src="https://farhateservices.github.io/fesa/logo-head-black.png" alt="Farhat e Services & Assistance" loading="lazy" class="h-5 filter bg-blend-multiply">Farhat e Services & Assistance</span></a></div>
  </footer>
  <script>
  // Define constants for element IDs
const inputFile = document.getElementById('input-file');
const previewImgDiv = document.getElementById('img-preview-div');
const previewImg = document.getElementById('img-preview');
const previewFileName = document.getElementById('selected-file-name');
const messageBox = document.getElementById('message');
const intialMessage = document.getElementById('log-0');
const logHistoryBox = document.getElementById('log-history');
const outputImg = document.getElementById('output-f-src');
const outputDFile = document.getElementById('output-d-file');
const outputB64CopyDiv = document.getElementById('output-b64-div');
const outputB64TickImg = document.getElementById('output-b64-tick-img');
const outputB64Message = document.getElementById('copy-b64-message');
const base64Snippet = document.getElementById('base64-snippet');
const form = document.getElementById('form');

// Event listener for file input change
inputFile.addEventListener('change', async () => {
  if (logHistoryBox.innerHTML.length <= 136) {
    logEvent('File reading started');
  } else {
    logHistoryBox.innerHTML = `<summary class="font-semibold transition rounded-md pb-2 text-sm md:text-base cursor-pointer">Detailed Log History</summary>
      <li class="list-decimal pl-4 text-sm md:text-base">File reading started - ${new Date().toLocaleTimeString()}.</li>`;
    intialMessage.innerHTML = `File reading started - ${new Date().toLocaleTimeString()}`;
  }
  intialMessage.classList.remove('hidden');
  logHistoryBox.classList.remove('hidden');

  const fileReader = new FileReader();

  fileReader.addEventListener('loadend', () => {
    const result = fileReader.result;
    previewImg.src = result;
    previewFileName.innerHTML = `<b class="font-semibold text-sm md:text-base p-2">Selected File:</b> ${inputFile.files[0].name}`;
    previewImgDiv.classList.remove('hidden');

    logEvent('Base 64 code generated');
    
    const rsplit = result.split("base64,")[1];
    base64Snippet.innerHTML = rsplit;

    logEvent('Cleaned base64 code');
    
    outputB64CopyDiv.classList.remove('hidden');
    base64Snippet.classList.remove('hidden');

    const imgObj = {
      base64: rsplit,
      type: inputFile.files[0].type,
      name: inputFile.files[0].name
    };

    outputDFile.href = result;
    outputImg.src = result;
    outputDFile.download = `Regenerated ${imgObj.name}`;
    outputDFile.classList.remove('hidden');

    logEvent('Regenerated the original file from base64 code');
  });

  fileReader.readAsDataURL(inputFile.files[0]);
});

// Event listener for clicking the "Copy Base64" button
outputB64CopyDiv.addEventListener('click', () => {
  logEvent('Copied generated base64 code');
  outputB64TickImg.classList.remove('hidden');

  // Create a temporary textarea element with a specified class
  const textarea = document.createElement('textarea');
  textarea.value = base64Snippet.innerHTML;

  // Append the textarea to the document
  document.body.appendChild(textarea);

  // Select the text in the textarea
  textarea.select();
  textarea.setSelectionRange(0, textarea.value.length);

  // Copy the selected text to the clipboard
  document.execCommand('copy');

  // Remove the temporary textarea from the document
  document.body.removeChild(textarea);
  
  outputB64Message.innerHTML = `Copied generated Base64 Code <i class="fa-solid fa-clipboard-check text-xl pl-2"></i>`;

  setTimeout(() => {
    outputB64TickImg.classList.add('hidden');
    outputB64Message.innerHTML = `Copy generated Base64 Code <i class="fa-solid fa-clipboard text-xl pl-2"></i>`;
  }, 5000);
});

// Event listener for clicking the "Download" link
outputDFile.addEventListener('click', () => {
  logEvent('File (regenerated from base64 code) downloaded successfully');
});

// Function to log events and update UI
function logEvent(message) {
  logHistoryBox.innerHTML += `<li class="list-decimal pl-4 text-sm md:text-base">${message} - ${new Date().toLocaleTimeString()}.</li>`;
  intialMessage.innerHTML = `${message} - ${new Date().toLocaleTimeString()}`;
}

  </script>
<!-- MY CODED JS FROM SCRATCH -->
<!--   
    <script>
    let inputFile = document.getElementById('input-file');
    let previewImgDiv = document.getElementById('img-preview-div')
    let previewImg = document.getElementById('img-preview')
    let previewFileName = document.getElementById('selected-file-name');
    let messageBox = document.getElementById('message');
    let intialMessage = document.getElementById('log-0');
    let logHistoryBox = document.getElementById('log-history');
    let outputImg = document.getElementById('output-f-src');
    let outputDFile = document.getElementById('output-d-file');
    let outputB64CopyDiv = document.getElementById('output-b64-div');
    let outputB64TickImg = document.getElementById('output-b64-tick-img');
    let outputB64Message = document.getElementById('copy-b64-message');
    let base64Snippet = document.getElementById('base64-snippet');
    let form = document.getElementById('form');

    

    inputFile.addEventListener('change', async () => {
      if(logHistoryBox.innerHTML.length<=136) {
        logHistoryBox.innerHTML += `<li class="list-decimal pl-4 text-sm md:text-base">File reading started - ${new Date().toLocaleTimeString()}.</li>`;
        intialMessage.innerHTML = `File reading started - ${new Date().toLocaleTimeString()}`;
      } else {
        logHistoryBox.innerHTML = `<summary class="font-semibold transition rounded-md pb-2 text-sm md:text-base cursor-pointer">Detailed Log History</summary>
        <li class="list-decimal pl-4 text-sm md:text-base">File reading started - ${new Date().toLocaleTimeString()}.</li>`;
        intialMessage.innerHTML = `File reading started - ${new Date().toLocaleTimeString()}`;
      }  
      intialMessage.classList.remove('hidden');
      logHistoryBox.classList.remove('hidden');

      let fileReader = await new FileReader();

      fileReader.addEventListener('loadend', () => {
        let result = fileReader.result;
        previewImg.src=result;
        previewFileName.innerHTML = `<b class="font-semibold text-sm md:text-base p-2">Selected File:</b> ${inputFile.files[0].name}`
        previewImgDiv.classList.remove('hidden');


        logHistoryBox.innerHTML += `<li class="list-decimal pl-4 text-sm md:text-base">Base 64 code generated - ${new Date().toLocaleTimeString()}.</li>`;
        intialMessage.innerHTML = `Base 64 code generated - ${new Date().toLocaleTimeString()}`;

        let rsplit = result.split("base64,")[1];
        base64Snippet.innerHTML = rsplit;

        logHistoryBox.innerHTML += `<li class="list-decimal pl-4 text-sm md:text-base">Cleaned base64 code - ${new Date().toLocaleTimeString()}.</li>`;
        intialMessage.innerHTML = `Cleaned base64 code - ${new Date().toLocaleTimeString()}`;
        
        outputB64CopyDiv.classList.remove('hidden');
        base64Snippet.classList.remove('hidden');


        let imgObj = {
          base64:rsplit,
          type:inputFile.files[0].type,
          name:inputFile.files[0].name
        };

        outputDFile.href = result;
        outputImg.src = result;
        outputDFile.download = `Regenerated ${imgObj.name}`;
        outputDFile.classList.remove('hidden');

        logHistoryBox.innerHTML += `<li class="list-decimal pl-4 text-sm md:text-base">Regenrated the origional file from base64 code - ${new Date().toLocaleTimeString()}.</li>`;
        intialMessage.innerHTML = `Regenrated the origional file from base64 code - ${new Date().toLocaleTimeString()}`;
      });

      fileReader.readAsDataURL(inputFile.files[0]);
    });

    outputDFile.addEventListener("click", () => {
      logHistoryBox.innerHTML += `<li class="list-decimal pl-4 text-sm md:text-base">File (regenerated from base64 code) downloaded sucessfully - ${new Date().toLocaleTimeString()}.</li>`;
      intialMessage.innerHTML = `File (regenerated from base64 code) downloaded sucessfully - ${new Date().toLocaleTimeString()}`;
    });

    outputB64CopyDiv.addEventListener("click", () => {

      logHistoryBox.innerHTML += `<li class="list-decimal pl-4 text-sm md:text-base">Copied generated base64 code - ${new Date().toLocaleTimeString()}.</li>`;
      intialMessage.innerHTML = `Copied generated base64 code - ${new Date().toLocaleTimeString()}`;

      outputB64TickImg.classList.remove('hidden');

      // Create a temporary textarea element with a specified class
      const textarea = document.createElement('textarea');
      textarea.value = base64Snippet.innerHTML;

      // Append the textarea to the document
      document.body.appendChild(textarea);

      // Select the text in the textarea
      textarea.select();
      textarea.setSelectionRange(0, textarea.value.length);

      // Copy the selected text to the clipboard
      document.execCommand('copy');

      // Remove the temporary textarea from the document
      document.body.removeChild(textarea);
      outputB64TickImg.classList.remove('hidden');
      outputB64Message.innerHTML = `Copied generated Base64 Code <i class="fa-solid fa-clipboard-check text-xl pl-2"></i>`; 

      setTimeout(() => {
        outputB64TickImg.classList.add('hidden');
        outputB64Message.innerHTML = `Copy generated Base64 Code <i class="fa-solid fa-clipboard text-xl pl-2"></i>`;
        console.log("5 sec done");  
      }, 5000);
    });

    // setInterval(() => {
    //   console.log(logHistoryBox.innerHTML.length);
    // }, 2000);

    </script> 
  -->
</body>
</html>